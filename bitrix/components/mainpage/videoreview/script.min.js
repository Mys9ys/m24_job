$(document).ready(function(){$(".video_review_box").on("click",".all_video_products",function(){$(this).parent().find(".video_products_unvis").show();$(this).parent().addClass("video_products_hidden");$(this).text("скрыть");$(this).addClass("close_video_products");$(this).removeClass("all_video_products")});$(".video_review_box").on("click",".close_video_products",function(){$(this).parent().find(".video_products_unvis").hide();$(this).parent().removeClass("video_products_hidden");$(this).text("еще +");$(this).removeClass("close_video_products");$(this).addClass("all_video_products")});$(".video_review_box").on("click",".all_video_tags",function(){$(this).parent().find(".video_tags_unvis").show();$(this).parent().addClass("video_tags_hidden");$(this).text("скрыть");$(this).addClass("close_video_tags");$(this).removeClass("all_video_tags")});$(".video_review_box").on("click",".close_video_tags",function(){$(this).parent().find(".video_tags_unvis").hide();$(this).parent().removeClass("video_tags_hidden");$(this).text("еще теги");$(this).removeClass("close_video_tags");$(this).addClass("all_video_tags")});pagen="";$(".video_review_box").on("click",".button_play_video",function(){ShowYTVideo($(this).attr("data-target"),$(this).attr("data-ytID"),$(this).attr("data-vidStart"));var e={verify:true,props:"views",id:$(this).attr("data-ytID")};console.log("data",e);$.post("/bitrix/components/mainpage/videoreview/ajax/",e,function(){})});var a=$(".ajax_get_vids_all").attr("data-pagen");var d=$(".ajax_get_vids_all").attr("data-pagemax");var b=$(".ajax_get_vids_blogs").attr("data-pagen");var c=$(".ajax_get_vids_blogs").attr("data-pagemax");pagenControls(a,d,".ajax_get_vids_all");pagenControls(b,c,".ajax_get_vids_blogs");$(".ajax_get_vids").on("click",".get_vids_button",function(){$(this).remove();var e=$(this).attr("data-selector");var h=$(e).attr("data-pagemax");if(!f){var f=$(e).attr("data-pagen")}var g={verify:true,selector:e,pagen:++f};$.post("/bitrix/components/mainpage/videoreview/ajax/",g,function(i){$.each(JSON.parse(i),function(k,j){$(e+"_box").append(getVidsCardAjax(j))})});pagenControls(f,h,e)});$(".search_vids_input").on("keyup",function(){var g=$(this);var e=$.trim(g.val()).toLowerCase();$(".vids_search_result").show();if(e.length>2){var f={request:e,verify:true};$.post("/bitrix/components/mainpage/videoreview/ajax/",f,function(h){if(h!="null"){$(".vids_search_result_box").children().remove();var i=0;$.each(JSON.parse(h),function(j,l){if(++i==11){return false}var k=CapitalReplace(l,String(e));content='<div class="search_item"><a class="search_link" href="/content/video_review/?tag='+l+'">'+k+"</a>";"</div>";$(".vids_search_result_box").append(content)});if(i>4){content='<div class="search_item search_link_all"><a href="/content/video_review/?tag='+e+'">Все видео по запросу: <i>'+e+"</i></a></div>";$(".vids_search_result_box").append(content)}}else{search_not_found()}})}else{search_not_found()}});$(".vids_search_result_close").click(function(){$(this).parent().hide()})});function pagenControls(b,c,a){if(b<c){$(a).attr("data-pagen",b);$(a).append('<div class="get_vids_button" data-selector="'+a+'">Показать еще видео</div>')}}function getVidsCardAjax(g){var i="",b=1,h="",f="";$.each(g.tags,function(k,j){if(b>5){h="video_tags_unvis";f='<div class="video_tags_btn all_video_tags">еще теги</div>'}i=i+' <a class="tags_item '+h+'" href="/content/video_review/?tag='+j+'">#'+j+"</a>";b++});i=i+f;var d="",c=1,a="",e="";$.each(g.products,function(k,j){if(c>3){a="video_products_unvis";e='<div class="video_products_btn all_video_products">еще +</div>'}d=d+'<a class="'+a+'" href="'+j.link+'"><img src="'+j.img+'" title="'+j.name+'"></a>';c++});d=d+e;content='<div class="video_all_box">                    <div class="video_title">'+g.NAME+'</div>                    <div class="panel_video" id="video_all'+g.ID+'">                        <img src="'+g.Pict+'" alt="">                        <div class="button_play_video video-button" data-ytID="'+g.vidID+'" data-target="video_all'+g.ID+'" data-vidStart="'+g.timeStart+'"><i class="fa fa-youtube-play" aria-hidden="true"></i></div>                    </div>                    <div class="video_tags">                        <span>Теги: </span>'+i+'                    </div>                    <div class="video_products">                        <span>Продукция: </span>'+d+"                    </div>                </div>";return content}function search_not_found(){$(".vids_search_result_box").children().remove();content="По вашему запросу ни чего не найдено";$(".vids_search_result_box").append("<p>"+content+"</p>")}function CapitalReplace(b,a){if(b.indexOf(a.charAt(0).toUpperCase())>-1){a=a.charAt(0).toUpperCase()+a.substr(1)}return b.replace(a,'<i style="color: rgb(156, 194, 24)">'+a+"</i>")};